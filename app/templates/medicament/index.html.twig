{% extends 'base.html.twig' %}

{% block title %}Accueil
{% endblock %}

{% block body %}
	<h1>Liste des médicaments</h1>

	{% for label, messages in app.flashes %}
		{% for message in messages %}
			<div class="alert alert-{{ label }}">
				{{ message }}
			</div>
		{% endfor %}
	{% endfor %}

	<div class="d-flex justify-content-between mb-3">
		<div class="d-flex">
			<button id="import-button" class="btn btn-primary" data-bs-toggle="modal" data-bs-target="#importModal">Importer les médicaments</button>
			<button id="delete-button" class="btn btn-danger ms-2" data-bs-toggle="modal" data-bs-target="#deleteModal">Supprimer tous les médicaments</button>
		</div>
		<form method="get" action="{{ path('app_medicament') }}" class="d-flex">
			<div class="search-container position-relative d-flex align-items-center w-100">
				<svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewbox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="search-icon feather feather-search">
					<circle cx="11" cy="11" r="8"></circle>
					<line x1="21" y1="21" x2="16.65" y2="16.65"></line>
				</svg>
				<input class="form-control search-input ps-5" value="{{ searchTerm }}" type="search" name="search" placeholder="Rechercher un médicament par nom" aria-label="Search">
				<button class="btn btn-search ms-auto" type="submit">Rechercher</button>
			</div>
		</form>
	</div>

	<div id="medicaments-table">
		<table border="1">
			<thead>
				<tr>
					<th>ID</th>
					<th>Code CIS</th>
					<th>Nom</th>
					<th>Forme Pharmaceutique</th>
					<th>Voie Administration</th>
					<th>État Autorisation</th>
					<th>État Commercialisation</th>
					<th>Date Commercialisation</th>
					<th>Fabricant</th>
					<th>Procédure</th>
				</tr>
			</thead>
			<tbody>
				{% for medicament in medicaments %}
					<tr>
						<td>{{ medicament.id }}</td>
						<td>{{ medicament.codeCis }}</td>
						<td>{{ medicament.nom }}</td>
						<td>{{ medicament.formePharmaceutique }}</td>
						<td>{{ medicament.voieAdministration }}</td>
						<td>{{ medicament.etatAutorisation }}</td>
						<td>{{ medicament.etatCommercialisation }}</td>
						<td>{{ medicament.dateCommercialisation ? medicament.dateCommercialisation|date('d/m/Y') : 'N/A' }}</td>
						<td>{{ medicament.fabricant }}</td>
						<td>{{ medicament.procedure }}</td>
					</tr>
				{% endfor %}
			</tbody>
		</table>
	</div>

	{% include 'modals/medicament_modals.html.twig' %}
{% endblock %}
